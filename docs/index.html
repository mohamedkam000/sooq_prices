<!DOCTYPE html>
<html lang="en" data-theme="system">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sooq Price</title>
  <meta name="theme-color" content="#6C5CE7" />
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Header / Navigation -->
  <header>
    <div class="container nav" role="navigation" aria-label="Primary">
      <a href="index.html" class="brand" style="text-decoration:none; color:inherit;">
        <img src="logo.png" alt="Sooq Price Logo" class="logo" style="width:50px; height:50px; object-fit:contain; vertical-align:middle;">
        <div>
          <div>Sooq <span style="color:hsl(var(--accent))">Price</span></div>
        </div>
      </a>

      <!-- Theme toggle moved here -->
      <div class="theme-toggle" role="group" aria-label="Theme mode">
        <button data-theme="light" aria-pressed="false" title="Light">‚òÄÔ∏è</button>
        <button data-theme="system" aria-pressed="true" title="System">üñ•Ô∏è</button>
        <button data-theme="dark" aria-pressed="false" title="Dark">üåô</button>
        <button class="btn btn-ghost" id="randomAccent">üé®</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="grid" id="productGrid">
      <article class="product-card" aria-label="Khartoum" data-url="khartoum.html">
        <div class="product-img"><img src="https://i0.wp.com/arabscountries.com/wp-content/uploads/2020/10/sudan-1.jpg" alt="Khartoum"></div>
        <div class="product-body">
          <div class="title">Khartoum</div>
        </div>
      </article>

      <article class="product-card" aria-label="River Nile">
        <div class="product-img"><img src="https://www.sudanakhbar.com/wp-content/uploads/2024/10/445.jpg" alt="River Nile"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">River Nile</div>
        </div>
      </article>

      <article class="product-card" aria-label="Al-Jazeera">
        <div class="product-img"><img src="https://www.alnilin.com/wp-content/uploads/2023/09/madani_kush-780x470.jpg" alt="Al-Jazeera"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Al-Jazeera</div>
        </div>
      </article>

      <article class="product-card" aria-label="Sinnar">
        <div class="product-img"><img src="https://kushnews.net/wp-content/uploads/2023/09/sinnar_kush.jpg" alt="Sinnar"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Sinnar</div>
        </div>
      </article>

      <article class="product-card" aria-label="Al-Gadarif">
        <div class="product-img"><img src="https://assafirarabi.com/wp-content/uploads/2024/04/29695030_610016156014204_5046027968230156596_n.jpg" alt="Al-Gadarif"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Al-Gadarif</div>
        </div>
      </article>

      <article class="product-card" aria-label="Kassala">
        <div class="product-img"><img src="https://saqraljidyanews.com/wp-content/uploads/2020/08/d6e7a4bc43ae7ef56f2bcf0bb6571f6e.jpg" alt="Kassala"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Kassala</div>
        </div>
      </article>

      <article class="product-card" aria-label="Red Sea">
        <div class="product-img"><img src="https://i0.wp.com/arabscountries.com/wp-content/uploads/2022/11/The-Red-Sea-1.jpg" alt="Red Sea"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Red Sea</div>
        </div>
      </article>

      <article class="product-card" aria-label="Northern Sudan">
        <div class="product-img"><img src="https://sudanjournal.com/wp-content/uploads/2021/01/a1bd13c5fc813f0c17a64c8d52265180.jpg" alt="Northern Sudan"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">Northern Sudan</div>
        </div>
      </article>

      <article class="product-card" aria-label="North Kordofan">
        <div class="product-img"><img src="https://alroya.news/wp-content/uploads/2023/07/%D8%A7%D9%84%D8%A3%D8%A8%D9%8A%D8%B6-%D8%AA%D9%88%D9%8A%D8%AA%D8%B1.jpg" alt="North Kordofan"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">North Kordofan</div>
        </div>
      </article>

      <article class="product-card" aria-label="South Kordofan">
        <div class="product-img"><img src="https://www.alrakoba.net/wp-content/uploads/2020/06/6c21f000fac35192633bba9e5f877b90.jpg.webp" alt="South Kordofan"><span class="badge">Alpha</span></div>
        <div class="product-body">
          <div class="title">South Kordofan</div>
        </div>
      </article>
    </div>
  </main>

  <footer class="container">
    <div style="display:flex; justify-content: space-between; gap:12px; flex-wrap:wrap;">
      <div>¬© 2025 Sooq Price. All rights reserved.</div>
      <div>Made by <span style="color:hsl(var(--accent))">Muhammad Kamal</span>.</div>
    </div>
  </footer>

  <script>
    // ------------------------------
    // Theme & Accent (Dynamic Colors)
    // ------------------------------
    (function(){
      const root = document.documentElement;
      const storageKey = 'ds-theme';
      const accentKey = 'ds-accent';

      const setThemeAttr = (mode) => {
        // mode: 'light' | 'dark' | 'system'
        root.setAttribute('data-theme', mode);
        localStorage.setItem(storageKey, mode);
        // update pressed state
        document.querySelectorAll('.theme-toggle button').forEach(btn => {
          btn.setAttribute('aria-pressed', String(btn.dataset.theme === mode));
        });
      };

      // Init theme from storage
      const savedTheme = localStorage.getItem(storageKey) || 'system';
      setThemeAttr(savedTheme);

      // Wire segmented buttons
      document.querySelectorAll('.theme-toggle button').forEach(btn => {
        btn.addEventListener('click', () => setThemeAttr(btn.dataset.theme));
      });

      // Accent color picker
      const savedAccent = localStorage.getItem(accentKey);
      if (savedAccent) {
        setAccent(savedAccent);
        const input = document.getElementById('accentPicker');
        if (input) input.value = rgbToHex(savedAccent);
      }

      const themeColorMeta = document.querySelector('meta[name="theme-color"]');
      function updateStatusBarColor(color) {
        if(themeColorMeta) {
          themeColorMeta.setAttribute('content', color);
        }
      }

      // Example: call when theme changes
      document.querySelectorAll('.theme-toggle button').forEach(btn => {
        btn.addEventListener('click', () => {
          const theme = btn.dataset.theme;
          if(theme === 'light') updateStatusBarColor('#ffffff');
          else if(theme === 'dark') updateStatusBarColor('#111111');
          else updateStatusBarColor('#f0f0f0'); // system or default
        });
      });

      document.getElementById('accentPicker')?.addEventListener('input', (e) => {
        const hex = e.target.value;
        const hsl = hexToHslString(hex);
        setAccent(hsl);
        localStorage.setItem(accentKey, hsl);
      });

      document.getElementById('randomAccent')?.addEventListener('click', () => {
        const palette = [
          '#E11D48', '#F59E0B', '#10B981', '#0EA5E9', '#6366F1', '#8B5CF6', '#EC4899', '#22D3EE', '#84CC16', '#F43F5E'
        ];
        const pick = palette[Math.floor(Math.random()*palette.length)];
        const hsl = hexToHslString(pick);
        setAccent(hsl);
        localStorage.setItem(accentKey, hsl);
        const input = document.getElementById('accentPicker');
        if (input) input.value = pick;
      });

      document.getElementById('themeBtn')?.addEventListener('click', () => {
        const order = ['light','system','dark'];
        const cur = root.getAttribute('data-theme') || 'system';
        const next = order[(order.indexOf(cur)+1)%order.length];
        setThemeAttr(next);
      });

      function setAccent(hslString) {
        // hslString like: "246 82% 61%" (no hsl wrapper) or "#hex" which we convert
        const val = hslString.includes('%') ? hslString : hexToHslString(hslString);
        root.style.setProperty('--accent', val);
        // Adjust theme-color for mobile address bar
        const meta = document.querySelector('meta[name="theme-color"]');
        if (meta) meta.setAttribute('content', hslToHex(val));
      }

      // Utilities: HEX <-> HSL conversions
      function hexToHslString(hex) {
        hex = hex.replace('#','');
        if (hex.length === 3) hex = hex.split('').map(x=>x+x).join('');
        const r = parseInt(hex.substring(0,2),16)/255;
        const g = parseInt(hex.substring(2,4),16)/255;
        const b = parseInt(hex.substring(4,6),16)/255;
        const max = Math.max(r,g,b), min = Math.min(r,g,b);
        let h, s, l = (max+min)/2;
        if (max===min) { h = s = 0; }
        else {
          const d = max-min;
          s = l > .5 ? d/(2-max-min) : d/(max+min);
          switch(max){
            case r: h = (g-b)/d + (g < b ? 6 : 0); break;
            case g: h = (b-r)/d + 2; break;
            case b: h = (r-g)/d + 4; break;
          }
          h /= 6;
        }
        return `${Math.round(h*360)} ${Math.round(s*100)}% ${Math.round(l*100)}%`;
      }
      function hslToHex(hslString){
        const [h,s,l] = hslString.replace(/%/g,'').split(' ').map(Number);
        const S=s/100, L=l/100;
        const C=(1-Math.abs(2*L-1))*S, X=C*(1-Math.abs((h/60)%2-1)), m=L-C/2;
        let r=0,g=0,b=0;
        if (0<=h && h<60) { r=C; g=X; b=0; }
        else if (60<=h && h<120) { r=X; g=C; b=0; }
        else if (120<=h && h<180) { r=0; g=C; b=X; }
        else if (180<=h && h<240) { r=0; g=X; b=C; }
        else if (240<=h && h<300) { r=X; g=0; b=C; }
        else { r=C; g=0; b=X; }
        const R=Math.round((r+m)*255), G=Math.round((g+m)*255), B=Math.round((b+m)*255);
        return `#${toHex(R)}${toHex(G)}${toHex(B)}`;
      }
      function rgbToHex(rgbString){
        // expects "h s% l%" already converted to hex via hslToHex
        return hslToHex(rgbString);
      }
      function toHex(n){ return n.toString(16).padStart(2,'0'); }
    })();

    document.querySelectorAll('.product-card').forEach(card => {
      card.addEventListener('click', () => {
        const url = card.dataset.url;
        fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, "text/html");
            const newContent = doc.querySelector("main").innerHTML; // only inner part
            document.querySelector("main").innerHTML = newContent;
            history.pushState({ page: url }, "", url);
          })
          .catch(err => console.error(err));
      });
    });


    window.addEventListener('popstate', e => {
      if (e.state && e.state.page) {
        fetch(e.state.page)
          .then(res => res.text())
          .then(html => {
            document.querySelector('main').innerHTML = html;
          });
      } else {
        location.reload(); // fallback to original page
      }
    });
    
  </script>
</body>
</html>
  
